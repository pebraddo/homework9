[
  {
    "objectID": "Basic Modeling Practice.html",
    "href": "Basic Modeling Practice.html",
    "title": "Homework 9 Modeling Practice - Continuation of Homework 8",
    "section": "",
    "text": "In this assignment, we are looking at the Seoul Bike Data from the UCI Machine Learning Repository. We are looking at the following variables of interest:\n• Date : day/month/year\n• Rented Bike count - Count of bikes rented at each hour\n• Hour - Hour of the day\n• Temperature-Temperature in Celsius\n• Humidity - %\n• Windspeed - m/s\n• Visibility - 10m\n• Dew point temperature - Celsius\n• Solar radiation - MJ/m2\n• Rainfall - mm\n• Snowfall - cm\n• Seasons - Winter, Spring, Summer, Autumn\n• Holiday - Holiday/No holiday\n• Functional Day - NoFunc(Non Functional Hours), Fun(Functional hours)\n\n\nLet’s look at the data using read_csv. We have to use the locale encoding of latin1 because of the degree symbol for temperature variables.\n\nlibrary(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.1     ✔ stringr   1.5.2\n✔ ggplot2   4.0.0     ✔ tibble    3.3.0\n✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n✔ purrr     1.1.0     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\n#originally got an error: what I think came from the degree symbol in one of the attributes.  the wild internet provided the locale = latin1 solution!\nseoul_bike_data &lt;- read_csv('https://www4.stat.ncsu.edu/~online/datasets/SeoulBikeData.csv', locale = locale(encoding = 'latin1'))\n\nRows: 8760 Columns: 14\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (4): Date, Seasons, Holiday, Functioning Day\ndbl (10): Rented Bike Count, Hour, Temperature(°C), Humidity(%), Wind speed ...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\nseoul_bike_data\n\n# A tibble: 8,760 × 14\n   Date       `Rented Bike Count`  Hour `Temperature(°C)` `Humidity(%)`\n   &lt;chr&gt;                    &lt;dbl&gt; &lt;dbl&gt;             &lt;dbl&gt;         &lt;dbl&gt;\n 1 01/12/2017                 254     0              -5.2            37\n 2 01/12/2017                 204     1              -5.5            38\n 3 01/12/2017                 173     2              -6              39\n 4 01/12/2017                 107     3              -6.2            40\n 5 01/12/2017                  78     4              -6              36\n 6 01/12/2017                 100     5              -6.4            37\n 7 01/12/2017                 181     6              -6.6            35\n 8 01/12/2017                 460     7              -7.4            38\n 9 01/12/2017                 930     8              -7.6            37\n10 01/12/2017                 490     9              -6.5            27\n# ℹ 8,750 more rows\n# ℹ 9 more variables: `Wind speed (m/s)` &lt;dbl&gt;, `Visibility (10m)` &lt;dbl&gt;,\n#   `Dew point temperature(°C)` &lt;dbl&gt;, `Solar Radiation (MJ/m2)` &lt;dbl&gt;,\n#   `Rainfall(mm)` &lt;dbl&gt;, `Snowfall (cm)` &lt;dbl&gt;, Seasons &lt;chr&gt;, Holiday &lt;chr&gt;,\n#   `Functioning Day` &lt;chr&gt;\n\n\n\n\n\nNow we must check the data… I’m starting with check for missingness: looks like we have na_counts of zero across the board for all columns! Whoop whoop whoop!\n\nsum_na &lt;- function(column){\n  sum(is.na(column) + is.null(column) + is.nan(column))\n}\nna_counts &lt;- seoul_bike_data |&gt;\n  summarize(across(everything(), sum_na))\nna_counts\n\n# A tibble: 1 × 14\n   Date `Rented Bike Count`  Hour `Temperature(°C)` `Humidity(%)`\n  &lt;int&gt;               &lt;int&gt; &lt;int&gt;             &lt;int&gt;         &lt;int&gt;\n1     0                   0     0                 0             0\n# ℹ 9 more variables: `Wind speed (m/s)` &lt;int&gt;, `Visibility (10m)` &lt;int&gt;,\n#   `Dew point temperature(°C)` &lt;int&gt;, `Solar Radiation (MJ/m2)` &lt;int&gt;,\n#   `Rainfall(mm)` &lt;int&gt;, `Snowfall (cm)` &lt;int&gt;, Seasons &lt;int&gt;, Holiday &lt;int&gt;,\n#   `Functioning Day` &lt;int&gt;\n\n\nNow, we must check the column types and the values within the columns to make sure they make sense. I’m using the psych package’s describe() for basic summary statistics for numeric columns. I’m checking the unique values for the categorical variables using unique().\n\nlibrary(psych)\n\n\nAttaching package: 'psych'\n\n\nThe following objects are masked from 'package:ggplot2':\n\n    %+%, alpha\n\npsych::describe(seoul_bike_data)\n\n                          vars    n    mean     sd  median trimmed    mad   min\nDate*                        1 8760  183.00 105.37  183.00  183.00 134.92   1.0\nRented Bike Count            2 8760  704.60 645.00  504.50  612.58 553.75   0.0\nHour                         3 8760   11.50   6.92   11.50   11.50   8.90   0.0\nTemperature(°C)              4 8760   12.88  11.94   13.70   13.19  13.94 -17.8\nHumidity(%)                  5 8760   58.23  20.36   57.00   58.02  23.72   0.0\nWind speed (m/s)             6 8760    1.72   1.04    1.50    1.63   1.04   0.0\nVisibility (10m)             7 8760 1436.83 608.30 1698.00 1509.50 447.75  27.0\nDew point temperature(°C)    8 8760    4.07  13.06    5.10    4.76  14.38 -30.6\nSolar Radiation (MJ/m2)      9 8760    0.57   0.87    0.01    0.38   0.01   0.0\nRainfall(mm)                10 8760    0.15   1.13    0.00    0.00   0.00   0.0\nSnowfall (cm)               11 8760    0.08   0.44    0.00    0.00   0.00   0.0\nSeasons*                    12 8760    2.50   1.11    2.00    2.49   1.48   1.0\nHoliday*                    13 8760    1.95   0.22    2.00    2.00   0.00   1.0\nFunctioning Day*            14 8760    1.97   0.18    2.00    2.00   0.00   1.0\n                              max   range  skew kurtosis   se\nDate*                      365.00  364.00  0.00    -1.20 1.13\nRented Bike Count         3556.00 3556.00  1.15     0.85 6.89\nHour                        23.00   23.00  0.00    -1.20 0.07\nTemperature(°C)             39.40   57.20 -0.20    -0.84 0.13\nHumidity(%)                 98.00   98.00  0.06    -0.80 0.22\nWind speed (m/s)             7.40    7.40  0.89     0.73 0.01\nVisibility (10m)          2000.00 1973.00 -0.70    -0.96 6.50\nDew point temperature(°C)   27.20   57.80 -0.37    -0.76 0.14\nSolar Radiation (MJ/m2)      3.52    3.52  1.50     1.12 0.01\nRainfall(mm)                35.00   35.00 14.53   284.76 0.01\nSnowfall (cm)                8.80    8.80  8.44    93.73 0.00\nSeasons*                     4.00    3.00  0.00    -1.35 0.01\nHoliday*                     2.00    1.00 -4.16    15.33 0.00\nFunctioning Day*             2.00    1.00 -5.17    24.72 0.00\n\nunique(seoul_bike_data$Seasons)\n\n[1] \"Winter\" \"Spring\" \"Summer\" \"Autumn\"\n\nunique(seoul_bike_data$Holiday) \n\n[1] \"No Holiday\" \"Holiday\"   \n\nunique(seoul_bike_data$`Functioning Day`)\n\n[1] \"Yes\" \"No\" \n\n\nLet’s convert the Date column into an actual date using the dmy() function from the lubridate package.\n\nlibrary(lubridate)\nseoul_bike_date &lt;-\n  seoul_bike_data |&gt; mutate(Date = dmy(Date))\n\nNow, we want to turn the character variables (Seasons, Holiday, and Functioning Day) into factors (remember those unique values from before?). We can rename all the variables to be lower snake case too.\n\nseoul_bike_data&lt;-\nseoul_bike_data |&gt;\n  mutate(Seasons = as.factor(Seasons),\n         Holiday = as.factor(Holiday),\n         `Functioning Day` = as.factor(`Functioning Day`)) |&gt;\n  rename('date'='Date',\n         'rented_bike_count' = 'Rented Bike Count',\n         'hour' = 'Hour',\n         'celcius_temp' = 'Temperature(°C)',\n         'percent_humidity'='Humidity(%)',\n         'wind_speed'= 'Wind speed (m/s)',\n         'visib'='Visibility (10m)',\n         'dew_point_temp' = 'Dew point temperature(°C)',\n         'solar_rad'='Solar Radiation (MJ/m2)',\n         'rainfall' = 'Rainfall(mm)',\n         'snowfall' = 'Snowfall (cm)',\n         'seasons' = 'Seasons',\n         'holiday' = 'Holiday',\n         'function_day' = 'Functioning Day')\n\nOnto creating summary statistics. The first contingency table is the data grouped by Functioning Day across Rented Bike Count with descriptive summaries of mean, median, variance, standard deviation, and interquartile range.\nWow! When functioning day is ‘no’, there were no bike rentals. Bike rentals only occurred on functioning days of ‘yes’.\n\nseoul_bike_data |&gt;\n  group_by(function_day) |&gt;\n  summarize(across(rented_bike_count, .fns = list(\"mean\" = mean, \n                                       \"median\" = median, \n                                       \"var\" = var, \n                                       \"sd\" = sd, \n                                       \"IQR\" = IQR), .names = \"{.fn}_{.col}\"))\n\n# A tibble: 2 × 6\n  function_day mean_rented_bike_count median_rented_bike_count\n  &lt;fct&gt;                         &lt;dbl&gt;                    &lt;dbl&gt;\n1 No                               0                         0\n2 Yes                            729.                      542\n# ℹ 3 more variables: var_rented_bike_count &lt;dbl&gt;, sd_rented_bike_count &lt;dbl&gt;,\n#   IQR_rented_bike_count &lt;dbl&gt;\n\n\nThis time, we will only look at functioning days of ‘yes’ where we summarize grouped by seasons and holiday variables. All four seasons have rented bike counts associated with them.\n\nseoul_bike_data |&gt;\n  group_by(seasons, holiday) |&gt;\n  filter(function_day == 'Yes') |&gt;\n  summarize(across(rented_bike_count, .fns = list(\"mean\" = mean, \n                                       \"median\" = median, \n                                       \"var\" = var, \n                                       \"sd\" = sd, \n                                       \"IQR\" = IQR), .names = \"{.fn}_{.col}\"))\n\n`summarise()` has grouped output by 'seasons'. You can override using the\n`.groups` argument.\n\n\n# A tibble: 8 × 7\n# Groups:   seasons [4]\n  seasons holiday    mean_rented_bike_count median_rented_bike_count\n  &lt;fct&gt;   &lt;fct&gt;                       &lt;dbl&gt;                    &lt;dbl&gt;\n1 Autumn  Holiday                      948.                     900 \n2 Autumn  No Holiday                   923.                     852 \n3 Spring  Holiday                      635.                     366.\n4 Spring  No Holiday                   750.                     605 \n5 Summer  Holiday                     1022.                     925 \n6 Summer  No Holiday                  1034.                     904.\n7 Winter  Holiday                      157.                     138 \n8 Winter  No Holiday                   232.                     212 \n# ℹ 3 more variables: var_rented_bike_count &lt;dbl&gt;, sd_rented_bike_count &lt;dbl&gt;,\n#   IQR_rented_bike_count &lt;dbl&gt;\n\n\nNow, we’ll summarize across the hours so that each day has one observation associated with it. We are grouping by Date.\n\nseoul_bike_data |&gt;\n  group_by(date) |&gt;\n  filter(function_day == 'Yes') |&gt;\n  summarize(across(rented_bike_count, .fns = list(\"mean\" = mean, \n                                       \"median\" = median), .names = \"{.fn}_{.col}\"))\n\n# A tibble: 353 × 3\n   date       mean_rented_bike_count median_rented_bike_count\n   &lt;chr&gt;                       &lt;dbl&gt;                    &lt;dbl&gt;\n 1 01/01/2018                   179.                    174. \n 2 01/02/2018                   224.                    238. \n 3 01/03/2018                   214.                    190. \n 4 01/04/2018                   724.                    662. \n 5 01/05/2018                  1118.                   1092  \n 6 01/06/2018                  1330.                   1156  \n 7 01/07/2018                   135.                     22.5\n 8 01/08/2018                   863                     673  \n 9 01/09/2018                  1084.                   1034. \n10 01/10/2018                  1163.                   1122. \n# ℹ 343 more rows\n\n\nNow let’s group across date, seasons, and holiday variables for the sums of rented bike count, rainfall, and snowfall and the averages of the weather variables.\n\nnew_bike_data &lt;- seoul_bike_data |&gt;\n  group_by(date, seasons, holiday) |&gt;\n  summarize(across(c(rented_bike_count,\n                     rainfall,\n                     snowfall), \n                   .fns=list('sum'=sum), \n                   .names = \"{.fn}_{.col}\"),\n            across(c(celcius_temp, \n                     percent_humidity,\n                     wind_speed,\n                     visib,\n                     dew_point_temp, \n                     solar_rad, \n                     rainfall,\n                     snowfall), \n                   .fns = list(\"mean\" = mean), \n                   .names = \"{.fn}_{.col}\")) |&gt; \n  mutate(date = dmy(date))\n\n`summarise()` has grouped output by 'date', 'seasons'. You can override using\nthe `.groups` argument.\n\nnew_bike_data\n\n# A tibble: 365 × 14\n# Groups:   date, seasons [365]\n   date       seasons holiday    sum_rented_bike_count sum_rainfall sum_snowfall\n   &lt;date&gt;     &lt;fct&gt;   &lt;fct&gt;                      &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;\n 1 2018-01-01 Winter  Holiday                     4290          0            0  \n 2 2018-02-01 Winter  No Holiday                  5377          0           21.7\n 3 2018-03-01 Spring  Holiday                     5132          2.5          0  \n 4 2018-04-01 Spring  No Holiday                 17388          0            0  \n 5 2018-05-01 Spring  Holiday                    26820          0            0  \n 6 2018-06-01 Summer  No Holiday                 31928          0            0  \n 7 2018-07-01 Summer  No Holiday                  3231         81            0  \n 8 2018-08-01 Summer  No Holiday                 20712          0            0  \n 9 2018-09-01 Autumn  No Holiday                 26010          0            0  \n10 2018-10-01 Autumn  No Holiday                 27909          0            0  \n# ℹ 355 more rows\n# ℹ 8 more variables: mean_celcius_temp &lt;dbl&gt;, mean_percent_humidity &lt;dbl&gt;,\n#   mean_wind_speed &lt;dbl&gt;, mean_visib &lt;dbl&gt;, mean_dew_point_temp &lt;dbl&gt;,\n#   mean_solar_rad &lt;dbl&gt;, mean_rainfall &lt;dbl&gt;, mean_snowfall &lt;dbl&gt;\n\n\nNow let’s use this data to recreate those basic summary statistics and then create some plots to explore relationships.\nFirst, we will create a contingency table of seasons and holiday variables. Most rented bike counts occurred on ‘not’ holidays. The highest count of rentals is in the summer for ‘not’ holidays and winter for holidays.\n\nnew_bike_data |&gt;\n  group_by(seasons, holiday)|&gt;\n  summarize(count=n()) |&gt;\n  pivot_wider(names_from = holiday, values_from = count)\n\n`summarise()` has grouped output by 'seasons'. You can override using the\n`.groups` argument.\n\n\n# A tibble: 4 × 3\n# Groups:   seasons [4]\n  seasons Holiday `No Holiday`\n  &lt;fct&gt;     &lt;int&gt;        &lt;int&gt;\n1 Autumn        5           86\n2 Spring        3           89\n3 Summer        2           90\n4 Winter        8           82\n\n\nWe can use psych’s describe() function again to get numeric summaries on this new data, like before.\nI also defined the numeric variables in the data as num_vars for easier use later.\n\nlibrary(corrr)\npsych::describe(new_bike_data)\n\nWarning in FUN(newX[, i], ...): no non-missing arguments to min; returning Inf\n\n\nWarning in FUN(newX[, i], ...): no non-missing arguments to max; returning -Inf\n\n\n                      vars   n     mean       sd   median  trimmed      mad\ndate                     1 365      NaN       NA       NA      NaN       NA\nseasons*                 2 365     2.50     1.12     2.00     2.49     1.48\nholiday*                 3 365     1.95     0.22     2.00     2.00     0.00\nsum_rented_bike_count    4 365 16910.45 10258.64 17730.00 16859.32 14654.02\nsum_rainfall             5 365     3.57    11.85     0.00     0.60     0.00\nsum_snowfall             6 365     1.80     8.66     0.00     0.00     0.00\nmean_celcius_temp        7 365    12.88    11.56    13.84    13.20    13.50\nmean_percent_humidity    8 365    58.23    14.67    57.21    57.75    14.70\nmean_wind_speed          9 365     1.72     0.60     1.64     1.66     0.50\nmean_visib              10 365  1436.83   491.25  1557.75  1486.04   565.49\nmean_dew_point_temp     11 365     4.07    12.81     5.01     4.67    14.39\nmean_solar_rad          12 365     0.57     0.31     0.56     0.56     0.41\nmean_rainfall           13 365     0.15     0.49     0.00     0.02     0.00\nmean_snowfall           14 365     0.08     0.36     0.00     0.00     0.00\n                         min      max    range  skew kurtosis     se\ndate                     Inf     -Inf     -Inf    NA       NA     NA\nseasons*                1.00     4.00     3.00  0.00    -1.36   0.06\nholiday*                1.00     2.00     1.00 -4.15    15.23   0.01\nsum_rented_bike_count   0.00 36149.00 36149.00 -0.03    -1.39 536.96\nsum_rainfall            0.00    95.50    95.50  4.85    26.25   0.62\nsum_snowfall            0.00    78.70    78.70  5.94    37.97   0.45\nmean_celcius_temp     -14.74    33.74    48.48 -0.24    -0.91   0.60\nmean_percent_humidity  22.25    95.88    73.62  0.26    -0.28   0.77\nmean_wind_speed         0.66     4.00     3.34  1.07     1.18   0.03\nmean_visib            214.29  2000.00  1785.71 -0.63    -0.74  25.71\nmean_dew_point_temp   -27.75    25.04    52.79 -0.32    -0.82   0.67\nmean_solar_rad          0.03     1.22     1.19  0.18    -1.08   0.02\nmean_rainfall           0.00     3.98     3.98  4.85    26.25   0.03\nmean_snowfall           0.00     3.28     3.28  5.94    37.97   0.02\n\nnum_vars &lt;- new_bike_data |&gt;\n  select(sum_rented_bike_count, sum_rainfall, sum_snowfall, mean_celcius_temp, mean_percent_humidity, mean_wind_speed, mean_visib, mean_dew_point_temp, mean_solar_rad, mean_rainfall, mean_snowfall)\n\nAdding missing grouping variables: `date`, `seasons`\n\nnum_vars\n\n# A tibble: 365 × 13\n# Groups:   date, seasons [365]\n   date       seasons sum_rented_bike_count sum_rainfall sum_snowfall\n   &lt;date&gt;     &lt;fct&gt;                   &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;\n 1 2018-01-01 Winter                   4290          0            0  \n 2 2018-02-01 Winter                   5377          0           21.7\n 3 2018-03-01 Spring                   5132          2.5          0  \n 4 2018-04-01 Spring                  17388          0            0  \n 5 2018-05-01 Spring                  26820          0            0  \n 6 2018-06-01 Summer                  31928          0            0  \n 7 2018-07-01 Summer                   3231         81            0  \n 8 2018-08-01 Summer                  20712          0            0  \n 9 2018-09-01 Autumn                  26010          0            0  \n10 2018-10-01 Autumn                  27909          0            0  \n# ℹ 355 more rows\n# ℹ 8 more variables: mean_celcius_temp &lt;dbl&gt;, mean_percent_humidity &lt;dbl&gt;,\n#   mean_wind_speed &lt;dbl&gt;, mean_visib &lt;dbl&gt;, mean_dew_point_temp &lt;dbl&gt;,\n#   mean_solar_rad &lt;dbl&gt;, mean_rainfall &lt;dbl&gt;, mean_snowfall &lt;dbl&gt;\n\n\nNow to plot… Let’s look at the rented bike count sums by date and holiday! Both the scatterplot and the overlapping holiday linear regression plots show an increase in the rental counts as the year goes on.\n\nggplot(new_bike_data, \n       aes(x=date, y=sum_rented_bike_count, color=holiday)) + \n  geom_point() + geom_smooth(method='lm') +\n  scale_x_date(date_labels = \"%B %d, %Y\") +\n  labs(title='Rented Bike Count Summed per Day in Seoul Scatterplot', x='Date',y='Rented Bike Count')\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\n\n\nggplot(new_bike_data, \n       aes(x=mean_rainfall, y=sum_rented_bike_count, color=mean_visib)) + \n  geom_point() + \n  labs(title='Rented Bike Count Summed per Day Versus \\nMean Rainfall and Mean Visibility in Seoul Scatterplot', x='Rainfall - mm',y='Rented Bike Count')\n\n\n\n\n\n\n\n\nNow let’s check where the x axis is mean snowfall and mean wind speed. The majority of bike rentals occur when there is no snowfall and low wind speed. There are a few dates with snowfall and rentals, but they mostly have lower wind speeds.\n\nggplot(new_bike_data, \n       aes(x=mean_snowfall, y=sum_rented_bike_count, color=mean_wind_speed)) + \n  geom_point() + \n  labs(title='Rented Bike Count Summed per Day Versus \\nMean Snowfall and Mean Wind Speed in Seoul Scatterplot', x='Rainfall - mm',y='Rented Bike Count')\n\n\n\n\n\n\n\n\nOOOh, a correlation matrix of the numeric variables we defined before.\nAs expected, mean rainfall and sum rainfall are very correlated, as well as mean snowfall and sum snowfall.\nMean Celcius Temp and Mean Dew Point Temp are also super correlated (0.96).\nThe most correlated variable with the Sum Rented Bike Count is Mean Celcius Temp. Let’s look at this and the next most correlated variable: solar radiation!\n\ncor_matrix &lt;- correlate(num_vars)\n\nNon-numeric variables removed from input: `date`, and `seasons`\nCorrelation computed with\n• Method: 'pearson'\n• Missing treated using: 'pairwise.complete.obs'\n\ncor_matrix &lt;- shave(cor_matrix)\nrplot(cor_matrix, print_cor = TRUE) + \n  theme(axis.text.x = element_text(angle = 60, hjust = 1))\n\nWarning: `aes_string()` was deprecated in ggplot2 3.0.0.\nℹ Please use tidy evaluation idioms with `aes()`.\nℹ See also `vignette(\"ggplot2-in-packages\")` for more information.\nℹ The deprecated feature was likely used in the corrr package.\n  Please report the issue at &lt;https://github.com/tidymodels/corrr/issues&gt;.\n\n\n\n\n\n\n\n\n\nThis is certainly a correlated relationship! The higher temperature has higher rental counts and higher solar radiation. Who would have thought?\n\nggplot(new_bike_data, \n       aes(x=mean_celcius_temp, y=sum_rented_bike_count, color=mean_solar_rad)) + \n  geom_point() + \n  labs(title='Rented Bike Count Summed per Day Versus \\nMean Temperature and Mean Solar Radiation \\nin Seoul Scatterplot', x='Temperature in Celcius',y='Rented Bike Count')\n\n\n\n\n\n\n\n\nMakes sense, because dew point temperature looks to be correlated as well.\n\nggplot(new_bike_data, \n       aes(x=mean_celcius_temp, y=sum_rented_bike_count, color=mean_dew_point_temp)) + \n  geom_point() + \n  labs(title='Rented Bike Count Summed per Day Versus \\nMean Temperature and Mean Dew Point Temperature \\nin Seoul Scatterplot', x='Temperature in Celcius',y='Rented Bike Count')"
  },
  {
    "objectID": "Basic Modeling Practice.html#reading-in-the-data",
    "href": "Basic Modeling Practice.html#reading-in-the-data",
    "title": "Homework 9 Modeling Practice - Continuation of Homework 8",
    "section": "",
    "text": "Let’s look at the data using read_csv. We have to use the locale encoding of latin1 because of the degree symbol for temperature variables.\n\nlibrary(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.1     ✔ stringr   1.5.2\n✔ ggplot2   4.0.0     ✔ tibble    3.3.0\n✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n✔ purrr     1.1.0     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\n#originally got an error: what I think came from the degree symbol in one of the attributes.  the wild internet provided the locale = latin1 solution!\nseoul_bike_data &lt;- read_csv('https://www4.stat.ncsu.edu/~online/datasets/SeoulBikeData.csv', locale = locale(encoding = 'latin1'))\n\nRows: 8760 Columns: 14\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (4): Date, Seasons, Holiday, Functioning Day\ndbl (10): Rented Bike Count, Hour, Temperature(°C), Humidity(%), Wind speed ...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\nseoul_bike_data\n\n# A tibble: 8,760 × 14\n   Date       `Rented Bike Count`  Hour `Temperature(°C)` `Humidity(%)`\n   &lt;chr&gt;                    &lt;dbl&gt; &lt;dbl&gt;             &lt;dbl&gt;         &lt;dbl&gt;\n 1 01/12/2017                 254     0              -5.2            37\n 2 01/12/2017                 204     1              -5.5            38\n 3 01/12/2017                 173     2              -6              39\n 4 01/12/2017                 107     3              -6.2            40\n 5 01/12/2017                  78     4              -6              36\n 6 01/12/2017                 100     5              -6.4            37\n 7 01/12/2017                 181     6              -6.6            35\n 8 01/12/2017                 460     7              -7.4            38\n 9 01/12/2017                 930     8              -7.6            37\n10 01/12/2017                 490     9              -6.5            27\n# ℹ 8,750 more rows\n# ℹ 9 more variables: `Wind speed (m/s)` &lt;dbl&gt;, `Visibility (10m)` &lt;dbl&gt;,\n#   `Dew point temperature(°C)` &lt;dbl&gt;, `Solar Radiation (MJ/m2)` &lt;dbl&gt;,\n#   `Rainfall(mm)` &lt;dbl&gt;, `Snowfall (cm)` &lt;dbl&gt;, Seasons &lt;chr&gt;, Holiday &lt;chr&gt;,\n#   `Functioning Day` &lt;chr&gt;"
  },
  {
    "objectID": "Basic Modeling Practice.html#eda",
    "href": "Basic Modeling Practice.html#eda",
    "title": "Homework 9 Modeling Practice - Continuation of Homework 8",
    "section": "",
    "text": "Now we must check the data… I’m starting with check for missingness: looks like we have na_counts of zero across the board for all columns! Whoop whoop whoop!\n\nsum_na &lt;- function(column){\n  sum(is.na(column) + is.null(column) + is.nan(column))\n}\nna_counts &lt;- seoul_bike_data |&gt;\n  summarize(across(everything(), sum_na))\nna_counts\n\n# A tibble: 1 × 14\n   Date `Rented Bike Count`  Hour `Temperature(°C)` `Humidity(%)`\n  &lt;int&gt;               &lt;int&gt; &lt;int&gt;             &lt;int&gt;         &lt;int&gt;\n1     0                   0     0                 0             0\n# ℹ 9 more variables: `Wind speed (m/s)` &lt;int&gt;, `Visibility (10m)` &lt;int&gt;,\n#   `Dew point temperature(°C)` &lt;int&gt;, `Solar Radiation (MJ/m2)` &lt;int&gt;,\n#   `Rainfall(mm)` &lt;int&gt;, `Snowfall (cm)` &lt;int&gt;, Seasons &lt;int&gt;, Holiday &lt;int&gt;,\n#   `Functioning Day` &lt;int&gt;\n\n\nNow, we must check the column types and the values within the columns to make sure they make sense. I’m using the psych package’s describe() for basic summary statistics for numeric columns. I’m checking the unique values for the categorical variables using unique().\n\nlibrary(psych)\n\n\nAttaching package: 'psych'\n\n\nThe following objects are masked from 'package:ggplot2':\n\n    %+%, alpha\n\npsych::describe(seoul_bike_data)\n\n                          vars    n    mean     sd  median trimmed    mad   min\nDate*                        1 8760  183.00 105.37  183.00  183.00 134.92   1.0\nRented Bike Count            2 8760  704.60 645.00  504.50  612.58 553.75   0.0\nHour                         3 8760   11.50   6.92   11.50   11.50   8.90   0.0\nTemperature(°C)              4 8760   12.88  11.94   13.70   13.19  13.94 -17.8\nHumidity(%)                  5 8760   58.23  20.36   57.00   58.02  23.72   0.0\nWind speed (m/s)             6 8760    1.72   1.04    1.50    1.63   1.04   0.0\nVisibility (10m)             7 8760 1436.83 608.30 1698.00 1509.50 447.75  27.0\nDew point temperature(°C)    8 8760    4.07  13.06    5.10    4.76  14.38 -30.6\nSolar Radiation (MJ/m2)      9 8760    0.57   0.87    0.01    0.38   0.01   0.0\nRainfall(mm)                10 8760    0.15   1.13    0.00    0.00   0.00   0.0\nSnowfall (cm)               11 8760    0.08   0.44    0.00    0.00   0.00   0.0\nSeasons*                    12 8760    2.50   1.11    2.00    2.49   1.48   1.0\nHoliday*                    13 8760    1.95   0.22    2.00    2.00   0.00   1.0\nFunctioning Day*            14 8760    1.97   0.18    2.00    2.00   0.00   1.0\n                              max   range  skew kurtosis   se\nDate*                      365.00  364.00  0.00    -1.20 1.13\nRented Bike Count         3556.00 3556.00  1.15     0.85 6.89\nHour                        23.00   23.00  0.00    -1.20 0.07\nTemperature(°C)             39.40   57.20 -0.20    -0.84 0.13\nHumidity(%)                 98.00   98.00  0.06    -0.80 0.22\nWind speed (m/s)             7.40    7.40  0.89     0.73 0.01\nVisibility (10m)          2000.00 1973.00 -0.70    -0.96 6.50\nDew point temperature(°C)   27.20   57.80 -0.37    -0.76 0.14\nSolar Radiation (MJ/m2)      3.52    3.52  1.50     1.12 0.01\nRainfall(mm)                35.00   35.00 14.53   284.76 0.01\nSnowfall (cm)                8.80    8.80  8.44    93.73 0.00\nSeasons*                     4.00    3.00  0.00    -1.35 0.01\nHoliday*                     2.00    1.00 -4.16    15.33 0.00\nFunctioning Day*             2.00    1.00 -5.17    24.72 0.00\n\nunique(seoul_bike_data$Seasons)\n\n[1] \"Winter\" \"Spring\" \"Summer\" \"Autumn\"\n\nunique(seoul_bike_data$Holiday) \n\n[1] \"No Holiday\" \"Holiday\"   \n\nunique(seoul_bike_data$`Functioning Day`)\n\n[1] \"Yes\" \"No\" \n\n\nLet’s convert the Date column into an actual date using the dmy() function from the lubridate package.\n\nlibrary(lubridate)\nseoul_bike_date &lt;-\n  seoul_bike_data |&gt; mutate(Date = dmy(Date))\n\nNow, we want to turn the character variables (Seasons, Holiday, and Functioning Day) into factors (remember those unique values from before?). We can rename all the variables to be lower snake case too.\n\nseoul_bike_data&lt;-\nseoul_bike_data |&gt;\n  mutate(Seasons = as.factor(Seasons),\n         Holiday = as.factor(Holiday),\n         `Functioning Day` = as.factor(`Functioning Day`)) |&gt;\n  rename('date'='Date',\n         'rented_bike_count' = 'Rented Bike Count',\n         'hour' = 'Hour',\n         'celcius_temp' = 'Temperature(°C)',\n         'percent_humidity'='Humidity(%)',\n         'wind_speed'= 'Wind speed (m/s)',\n         'visib'='Visibility (10m)',\n         'dew_point_temp' = 'Dew point temperature(°C)',\n         'solar_rad'='Solar Radiation (MJ/m2)',\n         'rainfall' = 'Rainfall(mm)',\n         'snowfall' = 'Snowfall (cm)',\n         'seasons' = 'Seasons',\n         'holiday' = 'Holiday',\n         'function_day' = 'Functioning Day')\n\nOnto creating summary statistics. The first contingency table is the data grouped by Functioning Day across Rented Bike Count with descriptive summaries of mean, median, variance, standard deviation, and interquartile range.\nWow! When functioning day is ‘no’, there were no bike rentals. Bike rentals only occurred on functioning days of ‘yes’.\n\nseoul_bike_data |&gt;\n  group_by(function_day) |&gt;\n  summarize(across(rented_bike_count, .fns = list(\"mean\" = mean, \n                                       \"median\" = median, \n                                       \"var\" = var, \n                                       \"sd\" = sd, \n                                       \"IQR\" = IQR), .names = \"{.fn}_{.col}\"))\n\n# A tibble: 2 × 6\n  function_day mean_rented_bike_count median_rented_bike_count\n  &lt;fct&gt;                         &lt;dbl&gt;                    &lt;dbl&gt;\n1 No                               0                         0\n2 Yes                            729.                      542\n# ℹ 3 more variables: var_rented_bike_count &lt;dbl&gt;, sd_rented_bike_count &lt;dbl&gt;,\n#   IQR_rented_bike_count &lt;dbl&gt;\n\n\nThis time, we will only look at functioning days of ‘yes’ where we summarize grouped by seasons and holiday variables. All four seasons have rented bike counts associated with them.\n\nseoul_bike_data |&gt;\n  group_by(seasons, holiday) |&gt;\n  filter(function_day == 'Yes') |&gt;\n  summarize(across(rented_bike_count, .fns = list(\"mean\" = mean, \n                                       \"median\" = median, \n                                       \"var\" = var, \n                                       \"sd\" = sd, \n                                       \"IQR\" = IQR), .names = \"{.fn}_{.col}\"))\n\n`summarise()` has grouped output by 'seasons'. You can override using the\n`.groups` argument.\n\n\n# A tibble: 8 × 7\n# Groups:   seasons [4]\n  seasons holiday    mean_rented_bike_count median_rented_bike_count\n  &lt;fct&gt;   &lt;fct&gt;                       &lt;dbl&gt;                    &lt;dbl&gt;\n1 Autumn  Holiday                      948.                     900 \n2 Autumn  No Holiday                   923.                     852 \n3 Spring  Holiday                      635.                     366.\n4 Spring  No Holiday                   750.                     605 \n5 Summer  Holiday                     1022.                     925 \n6 Summer  No Holiday                  1034.                     904.\n7 Winter  Holiday                      157.                     138 \n8 Winter  No Holiday                   232.                     212 \n# ℹ 3 more variables: var_rented_bike_count &lt;dbl&gt;, sd_rented_bike_count &lt;dbl&gt;,\n#   IQR_rented_bike_count &lt;dbl&gt;\n\n\nNow, we’ll summarize across the hours so that each day has one observation associated with it. We are grouping by Date.\n\nseoul_bike_data |&gt;\n  group_by(date) |&gt;\n  filter(function_day == 'Yes') |&gt;\n  summarize(across(rented_bike_count, .fns = list(\"mean\" = mean, \n                                       \"median\" = median), .names = \"{.fn}_{.col}\"))\n\n# A tibble: 353 × 3\n   date       mean_rented_bike_count median_rented_bike_count\n   &lt;chr&gt;                       &lt;dbl&gt;                    &lt;dbl&gt;\n 1 01/01/2018                   179.                    174. \n 2 01/02/2018                   224.                    238. \n 3 01/03/2018                   214.                    190. \n 4 01/04/2018                   724.                    662. \n 5 01/05/2018                  1118.                   1092  \n 6 01/06/2018                  1330.                   1156  \n 7 01/07/2018                   135.                     22.5\n 8 01/08/2018                   863                     673  \n 9 01/09/2018                  1084.                   1034. \n10 01/10/2018                  1163.                   1122. \n# ℹ 343 more rows\n\n\nNow let’s group across date, seasons, and holiday variables for the sums of rented bike count, rainfall, and snowfall and the averages of the weather variables.\n\nnew_bike_data &lt;- seoul_bike_data |&gt;\n  group_by(date, seasons, holiday) |&gt;\n  summarize(across(c(rented_bike_count,\n                     rainfall,\n                     snowfall), \n                   .fns=list('sum'=sum), \n                   .names = \"{.fn}_{.col}\"),\n            across(c(celcius_temp, \n                     percent_humidity,\n                     wind_speed,\n                     visib,\n                     dew_point_temp, \n                     solar_rad, \n                     rainfall,\n                     snowfall), \n                   .fns = list(\"mean\" = mean), \n                   .names = \"{.fn}_{.col}\")) |&gt; \n  mutate(date = dmy(date))\n\n`summarise()` has grouped output by 'date', 'seasons'. You can override using\nthe `.groups` argument.\n\nnew_bike_data\n\n# A tibble: 365 × 14\n# Groups:   date, seasons [365]\n   date       seasons holiday    sum_rented_bike_count sum_rainfall sum_snowfall\n   &lt;date&gt;     &lt;fct&gt;   &lt;fct&gt;                      &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;\n 1 2018-01-01 Winter  Holiday                     4290          0            0  \n 2 2018-02-01 Winter  No Holiday                  5377          0           21.7\n 3 2018-03-01 Spring  Holiday                     5132          2.5          0  \n 4 2018-04-01 Spring  No Holiday                 17388          0            0  \n 5 2018-05-01 Spring  Holiday                    26820          0            0  \n 6 2018-06-01 Summer  No Holiday                 31928          0            0  \n 7 2018-07-01 Summer  No Holiday                  3231         81            0  \n 8 2018-08-01 Summer  No Holiday                 20712          0            0  \n 9 2018-09-01 Autumn  No Holiday                 26010          0            0  \n10 2018-10-01 Autumn  No Holiday                 27909          0            0  \n# ℹ 355 more rows\n# ℹ 8 more variables: mean_celcius_temp &lt;dbl&gt;, mean_percent_humidity &lt;dbl&gt;,\n#   mean_wind_speed &lt;dbl&gt;, mean_visib &lt;dbl&gt;, mean_dew_point_temp &lt;dbl&gt;,\n#   mean_solar_rad &lt;dbl&gt;, mean_rainfall &lt;dbl&gt;, mean_snowfall &lt;dbl&gt;\n\n\nNow let’s use this data to recreate those basic summary statistics and then create some plots to explore relationships.\nFirst, we will create a contingency table of seasons and holiday variables. Most rented bike counts occurred on ‘not’ holidays. The highest count of rentals is in the summer for ‘not’ holidays and winter for holidays.\n\nnew_bike_data |&gt;\n  group_by(seasons, holiday)|&gt;\n  summarize(count=n()) |&gt;\n  pivot_wider(names_from = holiday, values_from = count)\n\n`summarise()` has grouped output by 'seasons'. You can override using the\n`.groups` argument.\n\n\n# A tibble: 4 × 3\n# Groups:   seasons [4]\n  seasons Holiday `No Holiday`\n  &lt;fct&gt;     &lt;int&gt;        &lt;int&gt;\n1 Autumn        5           86\n2 Spring        3           89\n3 Summer        2           90\n4 Winter        8           82\n\n\nWe can use psych’s describe() function again to get numeric summaries on this new data, like before.\nI also defined the numeric variables in the data as num_vars for easier use later.\n\nlibrary(corrr)\npsych::describe(new_bike_data)\n\nWarning in FUN(newX[, i], ...): no non-missing arguments to min; returning Inf\n\n\nWarning in FUN(newX[, i], ...): no non-missing arguments to max; returning -Inf\n\n\n                      vars   n     mean       sd   median  trimmed      mad\ndate                     1 365      NaN       NA       NA      NaN       NA\nseasons*                 2 365     2.50     1.12     2.00     2.49     1.48\nholiday*                 3 365     1.95     0.22     2.00     2.00     0.00\nsum_rented_bike_count    4 365 16910.45 10258.64 17730.00 16859.32 14654.02\nsum_rainfall             5 365     3.57    11.85     0.00     0.60     0.00\nsum_snowfall             6 365     1.80     8.66     0.00     0.00     0.00\nmean_celcius_temp        7 365    12.88    11.56    13.84    13.20    13.50\nmean_percent_humidity    8 365    58.23    14.67    57.21    57.75    14.70\nmean_wind_speed          9 365     1.72     0.60     1.64     1.66     0.50\nmean_visib              10 365  1436.83   491.25  1557.75  1486.04   565.49\nmean_dew_point_temp     11 365     4.07    12.81     5.01     4.67    14.39\nmean_solar_rad          12 365     0.57     0.31     0.56     0.56     0.41\nmean_rainfall           13 365     0.15     0.49     0.00     0.02     0.00\nmean_snowfall           14 365     0.08     0.36     0.00     0.00     0.00\n                         min      max    range  skew kurtosis     se\ndate                     Inf     -Inf     -Inf    NA       NA     NA\nseasons*                1.00     4.00     3.00  0.00    -1.36   0.06\nholiday*                1.00     2.00     1.00 -4.15    15.23   0.01\nsum_rented_bike_count   0.00 36149.00 36149.00 -0.03    -1.39 536.96\nsum_rainfall            0.00    95.50    95.50  4.85    26.25   0.62\nsum_snowfall            0.00    78.70    78.70  5.94    37.97   0.45\nmean_celcius_temp     -14.74    33.74    48.48 -0.24    -0.91   0.60\nmean_percent_humidity  22.25    95.88    73.62  0.26    -0.28   0.77\nmean_wind_speed         0.66     4.00     3.34  1.07     1.18   0.03\nmean_visib            214.29  2000.00  1785.71 -0.63    -0.74  25.71\nmean_dew_point_temp   -27.75    25.04    52.79 -0.32    -0.82   0.67\nmean_solar_rad          0.03     1.22     1.19  0.18    -1.08   0.02\nmean_rainfall           0.00     3.98     3.98  4.85    26.25   0.03\nmean_snowfall           0.00     3.28     3.28  5.94    37.97   0.02\n\nnum_vars &lt;- new_bike_data |&gt;\n  select(sum_rented_bike_count, sum_rainfall, sum_snowfall, mean_celcius_temp, mean_percent_humidity, mean_wind_speed, mean_visib, mean_dew_point_temp, mean_solar_rad, mean_rainfall, mean_snowfall)\n\nAdding missing grouping variables: `date`, `seasons`\n\nnum_vars\n\n# A tibble: 365 × 13\n# Groups:   date, seasons [365]\n   date       seasons sum_rented_bike_count sum_rainfall sum_snowfall\n   &lt;date&gt;     &lt;fct&gt;                   &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;\n 1 2018-01-01 Winter                   4290          0            0  \n 2 2018-02-01 Winter                   5377          0           21.7\n 3 2018-03-01 Spring                   5132          2.5          0  \n 4 2018-04-01 Spring                  17388          0            0  \n 5 2018-05-01 Spring                  26820          0            0  \n 6 2018-06-01 Summer                  31928          0            0  \n 7 2018-07-01 Summer                   3231         81            0  \n 8 2018-08-01 Summer                  20712          0            0  \n 9 2018-09-01 Autumn                  26010          0            0  \n10 2018-10-01 Autumn                  27909          0            0  \n# ℹ 355 more rows\n# ℹ 8 more variables: mean_celcius_temp &lt;dbl&gt;, mean_percent_humidity &lt;dbl&gt;,\n#   mean_wind_speed &lt;dbl&gt;, mean_visib &lt;dbl&gt;, mean_dew_point_temp &lt;dbl&gt;,\n#   mean_solar_rad &lt;dbl&gt;, mean_rainfall &lt;dbl&gt;, mean_snowfall &lt;dbl&gt;\n\n\nNow to plot… Let’s look at the rented bike count sums by date and holiday! Both the scatterplot and the overlapping holiday linear regression plots show an increase in the rental counts as the year goes on.\n\nggplot(new_bike_data, \n       aes(x=date, y=sum_rented_bike_count, color=holiday)) + \n  geom_point() + geom_smooth(method='lm') +\n  scale_x_date(date_labels = \"%B %d, %Y\") +\n  labs(title='Rented Bike Count Summed per Day in Seoul Scatterplot', x='Date',y='Rented Bike Count')\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\n\n\nggplot(new_bike_data, \n       aes(x=mean_rainfall, y=sum_rented_bike_count, color=mean_visib)) + \n  geom_point() + \n  labs(title='Rented Bike Count Summed per Day Versus \\nMean Rainfall and Mean Visibility in Seoul Scatterplot', x='Rainfall - mm',y='Rented Bike Count')\n\n\n\n\n\n\n\n\nNow let’s check where the x axis is mean snowfall and mean wind speed. The majority of bike rentals occur when there is no snowfall and low wind speed. There are a few dates with snowfall and rentals, but they mostly have lower wind speeds.\n\nggplot(new_bike_data, \n       aes(x=mean_snowfall, y=sum_rented_bike_count, color=mean_wind_speed)) + \n  geom_point() + \n  labs(title='Rented Bike Count Summed per Day Versus \\nMean Snowfall and Mean Wind Speed in Seoul Scatterplot', x='Rainfall - mm',y='Rented Bike Count')\n\n\n\n\n\n\n\n\nOOOh, a correlation matrix of the numeric variables we defined before.\nAs expected, mean rainfall and sum rainfall are very correlated, as well as mean snowfall and sum snowfall.\nMean Celcius Temp and Mean Dew Point Temp are also super correlated (0.96).\nThe most correlated variable with the Sum Rented Bike Count is Mean Celcius Temp. Let’s look at this and the next most correlated variable: solar radiation!\n\ncor_matrix &lt;- correlate(num_vars)\n\nNon-numeric variables removed from input: `date`, and `seasons`\nCorrelation computed with\n• Method: 'pearson'\n• Missing treated using: 'pairwise.complete.obs'\n\ncor_matrix &lt;- shave(cor_matrix)\nrplot(cor_matrix, print_cor = TRUE) + \n  theme(axis.text.x = element_text(angle = 60, hjust = 1))\n\nWarning: `aes_string()` was deprecated in ggplot2 3.0.0.\nℹ Please use tidy evaluation idioms with `aes()`.\nℹ See also `vignette(\"ggplot2-in-packages\")` for more information.\nℹ The deprecated feature was likely used in the corrr package.\n  Please report the issue at &lt;https://github.com/tidymodels/corrr/issues&gt;.\n\n\n\n\n\n\n\n\n\nThis is certainly a correlated relationship! The higher temperature has higher rental counts and higher solar radiation. Who would have thought?\n\nggplot(new_bike_data, \n       aes(x=mean_celcius_temp, y=sum_rented_bike_count, color=mean_solar_rad)) + \n  geom_point() + \n  labs(title='Rented Bike Count Summed per Day Versus \\nMean Temperature and Mean Solar Radiation \\nin Seoul Scatterplot', x='Temperature in Celcius',y='Rented Bike Count')\n\n\n\n\n\n\n\n\nMakes sense, because dew point temperature looks to be correlated as well.\n\nggplot(new_bike_data, \n       aes(x=mean_celcius_temp, y=sum_rented_bike_count, color=mean_dew_point_temp)) + \n  geom_point() + \n  labs(title='Rented Bike Count Summed per Day Versus \\nMean Temperature and Mean Dew Point Temperature \\nin Seoul Scatterplot', x='Temperature in Celcius',y='Rented Bike Count')"
  }
]